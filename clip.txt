[dtangalychev@noc1 ~]$ cat netconf/f1.dc1 | perl -e 'while(<>){/^object\s+\S+(.*)/ && ($ofl="object$1") && next; /^(\s+.*)/ && $ofl && ($Obj{$ofl} .= $1) && next; $ofl = 0; /tcp (.*) object wazuh-mng3 eq 1514/ && print exists $Obj{$1} ? "$1: $Obj{$1}\n" : "$1\n"};' | sort
10.111.10.0 255.255.255.0
10.111.11.0 255.255.255.0
10.111.12.0 255.255.255.0
10.111.13.0 255.255.255.0
10.111.138.0 255.255.255.0
10.111.14.0 255.255.255.0
10.111.15.0 255.255.255.0
10.111.16.0 255.255.255.0
10.111.17.0 255.255.255.0
10.111.18.0 255.255.255.0
10.111.20.0 255.255.255.0
10.111.21.0 255.255.255.0
10.111.23.0 255.255.255.0
10.111.25.0 255.255.255.0
10.111.26.0 255.255.255.0
10.111.27.0 255.255.255.0
10.111.28.0 255.255.255.0
10.111.29.0 255.255.255.0
10.111.30.0 255.255.255.0
10.111.37.0 255.255.255.0
10.111.56.0 255.255.255.0
10.111.57.0 255.255.255.0
10.111.63.0 255.255.255.0
10.111.64.0 255.255.255.0
10.111.65.0 255.255.255.0
object ing-ad-dns-nps:  host 10.111.52.12
object ing-svcg2:  host 10.111.46.11
object ocvpn-host:  host 10.111.0.37
[dtangalychev@noc1 ~]$ cat netconf/f3.dc2 | perl -e 'while(<>){/^object\s+\S+(.*)/ && ($ofl="object$1") && next; /^(\s+.*)/ && $ofl && ($Obj{$ofl} .= $1) && next; $ofl = 0; /tcp (.*) object wazuh-mng1 eq 1514/ && print exists $Obj{$1} ? "$1: $Obj{$1}\n" : "$1\n"};' | sort
10.222.10.0 255.255.255.0
10.222.11.0 255.255.255.0
10.222.12.0 255.255.255.0
10.222.13.0 255.255.255.0
10.222.14.0 255.255.255.0
10.222.15.0 255.255.255.0
10.222.16.0 255.255.255.0
10.222.17.0 255.255.255.0
10.222.18.0 255.255.255.0
10.222.20.0 255.255.255.0
10.222.21.0 255.255.255.0
10.222.23.0 255.255.255.0
10.222.25.0 255.255.255.0
10.222.26.0 255.255.255.0
10.222.27.0 255.255.255.0
10.222.28.0 255.255.255.0
10.222.29.0 255.255.255.0
10.222.30.0 255.255.255.0
10.222.37.0 255.255.255.0
10.222.39.0 255.255.255.0
object acsdb-test-net.dc2:  subnet 10.222.60.0 255.255.255.0
object acs-test-net.dc2:  subnet 10.222.35.0 255.255.255.0
object sbpgw-network:  subnet 10.222.71.0 255.255.255.0

